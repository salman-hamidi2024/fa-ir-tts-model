# ูพุฑูฺู ุณุงุฎุช TTS ูุงุฑุณ (Text-to-Speech)

ุงู ุฑุงูููุง ฺฉ ูุณุฑ **ุงุณุชุงูุฏุงุฑุฏ ู ุนูู** ุจุฑุง ุณุงุฎุช ฺฉ ุณุณุชู **ุชุจุฏู ูุชู ุจู ฺฏูุชุงุฑ (TTS)** ูุงุฑุณ ุงุฒ ุตูุฑ ุชุง ุตุฏ ุจุง ูพุงุชูู ุงุฑุงุฆู ูโุฏูุฏ. ูุฏู ุจูโุตูุฑุช ูุงู `.h5` ุฐุฎุฑู ูโุดูุฏ ุชุง ุจุชูุงูุฏ ุจุนุฏุงู ุฏูุจุงุฑู ุจุงุฑฺฏุฐุงุฑ ู ุขููุฒุด ุขู ุฑุง ุงุฏุงูู ุฏูุฏ.

> โ๏ธ ุชูุฌู: ุณุงุฎุชู ฺฉ TTS "ุจโููุต" ูุงุฒููุฏ ุฏุงุฏู ุฒุงุฏุ GPU ูู ู ูุนูุงุฑโูุง ูพุดุฑูุชู (ูุซู Tacotron2/FastSpeech2 + HiFi-GAN) ุงุณุช. ุงู ูพุฑูฺู ูพุงูโุง ุงุณุช ุงูุง ุงุณุชุงูุฏุงุฑุฏ ู ูุงุจู ุงุฑุชูุง.

---

## ูพุดโูุงุฒูุง

### ูุตุจ ฺฉุชุงุจุฎุงููโูุง

```bash
pip install numpy pandas librosa soundfile tensorflow==2.12 tqdm unidecode
```

* **TensorFlow**: ุจุฑุง ุชุนุฑู ู ุขููุฒุด ูุฏู.
* **Librosa**: ูพุฑุฏุงุฒุด ุตูุช (mel spectrogram).
* **Soundfile**: ุฐุฎุฑู ูุงู WAV.
* **Unidecode / Regex**: ูพุงฺฉโุณุงุฒ ูุชู.
* **TQDM**: ููุงุฑ ูพุดุฑูุช.

ุงฺฏุฑ GPU ุฏุงุฑุ ุจูุชุฑู ูุณุฎู GPU TensorFlow ูุตุจ ฺฉู.

---

## ุณุงุฎุชุงุฑ ูพูุดูโูุง

```
tts_project/
โโ data/
โ  โโ metadata.csv        # ูุฑ ุฑุฏู: "wav_filename|transcript"
โ  โโ wavs/
โ  โ  โโ 0001.wav
โ  โ  โโ 0002.wav
โ  โ  โโ ...
โโ checkpoints/
โโ outputs/
โโ main.py
โโ requirements.txt
```

### ูุฑูุช ุฏุชุงุณุช

* **ุตูุช**: ูุฑูุช WAVุ ููููุ 22050Hzุ 16-bit.
* **ูุชู**: ูุงุฑุณ ูุฑูุงูโุดุฏูุ ุจุฏูู ฺฉุงุฑุงฺฉุชุฑูุง ุงุถุงู.
* **metadata.csv**:

```csv
wavs/0001.wav|ุณูุงู ุจู ุฏูุง
wavs/0002.wav|ูู ุงุณูู ุณููุงู ุงุณุช
```

> ๐ ุจุฑุง ุดุฑูุนุ ุญุฏุงูู ฒโฑฐ ุณุงุนุช ุฏุงุฏู ฺฏูุชุงุฑ ุชูุฒ ุชูุตู ูโุดูุฏ.

---

## ูุงู main.py

ฺฉุฏ ุงุตู ูพุฑูฺู ุฏุฑ ูุงู `main.py` ูุฑุงุฑ ุฏุงุฑุฏ. ุงู ฺฉุฏ ุดุงูู ุจุฎุดโูุง ุฒุฑ ุงุณุช:

1. **ูพุดโูพุฑุฏุงุฒุด ูุชู**: ูุฑูุงูโุณุงุฒ ู ุชุจุฏู ุจู ุชูฺฉูโูุง.
2. **ูพุดโูพุฑุฏุงุฒุด ุตูุช**: ุชุจุฏู WAV ุจู Mel-Spectrogram.
3. **ุณุงุฎุช ุฏุชุงุณุช**: ุจุงุฑฺฏุฐุงุฑ ููุฒูุงู ูุชู ู mel.
4. **ุชุนุฑู ูุฏู**: Encoder-Decoder ุณุงุฏู ุจุง Keras.
5. **ุขููุฒุด ู ุฐุฎุฑู ูุฏู ุจู ูุฑูุช `.h5`.**
6. **ุณูุชุฒ ฺฏูุชุงุฑ**: ุชููุฏ WAV ุงุฒ ูุชู.
7. **ุงุฏุงููู ุขููุฒุด**: ุจุงุฑฺฏุฐุงุฑ ูุฏู ู ุงุฏุงูู ุฏุงุฏู.

---

## ุขููุฒุด ูุฏู

ุจุฑุง ุขููุฒุด:

```bash
python main.py --mode train
```

* ุฎุฑูุฌ: ูุงู `tts_model.h5` ุฏุฑ ูพูุดูู ุงุตู ุฐุฎุฑู ูโุดูุฏ.
* ุจูุชุฑู checkpoint ูู ุฏุฑ ูพูุดูู `checkpoints/` ุฐุฎุฑู ูโุดูุฏ.

---

## ุชุณุช ู ุณูุชุฒ ฺฏูุชุงุฑ

ุจุฑุง ุชููุฏ ุตูุช ุงุฒ ูุชู:

```bash
python main.py --mode synth --text "ุณูุงู ุฏูุง" --model tts_model.h5
```

ุฎุฑูุฌ ุฏุฑ ูพูุดูู `outputs/sample.wav` ุฐุฎุฑู ูโุดูุฏ.

---

## ุงุฏุงููู ุขููุฒุด ูุฏู

ุจุฑุง ุงุฏุงูู ุขููุฒุด ุงุฒ checkpoint:

```bash
python main.py --mode continue --model checkpoints/tts_best.h5
```

ูุฏู ุฌุฏุฏ ุจู ูุงู `tts_model_cont.h5` ุฐุฎุฑู ูโุดูุฏ.

---

## ุฏุชุงุณุช ู ุขูุงุฏูโุณุงุฒ

### ุตูุช

* ุถุจุท ุง ุฌูุนโุขูุฑ ูุงูโูุง WAV.
* trim ุณฺฉูุชโูุง ุงุถุงู.
* ูุฑูุงูโุณุงุฒ ุณุทุญ ุตุฏุง.
* ุชฺฉโฺฏููุฏู ุจูุชุฑ ุงุฒ ฺูุฏฺฏููุฏู ุงุณุช (ฺฉูุช ุจุงูุง).

### ูุชู

* ูุฑูุงูโุณุงุฒ: ุญุฐู ุนูุงุฆูุ ุชุจุฏู ุงุนุฏุงุฏ ุจู ุญุฑูู.
* (ุงุฎุชุงุฑ) **ููููโุณุงุฒ** ุจุฑุง ุจูุจูุฏ ุชููุธ.

---

## ุนุจโุงุจ ู ูุดฺฉูุงุช ุฑุงุฌ

* ๐ **ุตุฏุง ุฎุดโุฏุงุฑ** โ ูุดฺฉู vocoder (Griffin-Lim ุณุงุฏู ุงุณุช โ ุงุฑุชูุง ุจู HiFi-GAN).
* ๐ฃ๏ธ **ุชููุธ ุงุดุชุจุงู** โ ูุงุฒ ุจู ููููโุณุงุฒ ุง ูุบุชโูุงูู.
* ๐ **ฺฉูุฏ ุขููุฒุด** โ ฺฉุงูุด ุทูู sequence ุง batch size.
* ๐ **loss ฺฉู ููโุดูุฏ** โ ฺฺฉ ฺฉุฑุฏู ุฏุชุงุณุช ู learning rate.

---

## ูุชุฑฺฉโูุง ู ุงุฑุฒุงุจ

* **MOS (Mean Opinion Score)**: ุจูุชุฑู ุฑูุด (ุงุฑุฒุงุจ ุงูุณุงู).
* **MSE ุฑู mel**: ูุนุงุฑ ุขููุฒุด.
* **MCD (Mel Cepstral Distortion)**: ุงุฑุฒุงุจ ฺฉู ฺฉูุช ุตูุช.

---

## ูุณุฑ ุงุฑุชูุง

1. ุฌุงฺฏุฒู ฺฉุฑุฏู ูุฏู ุณุงุฏู ุจุง **Tacotron2** ุง **FastSpeech2**.
2. ุฌุงฺฏุฒู Griffin-Lim ุจุง vocoderูุง **HiFi-GAN / WaveGlow / WaveRNN**.
3. ุงูุฒูุฏู **ููููโุณุงุฒ ูุงุฑุณ** ุจุฑุง ุชููุธ ุฏููโุชุฑ.
4. ุฌูุนโุขูุฑ ุฏุชุงุณุช ุจุฒุฑฺฏโุชุฑ (ฑฐโตฐ ุณุงุนุช).

---

## ุจุงุฑฺฏุฐุงุฑ ูุฏู ุจุฑุง ุงุณุชูุงุฏู ูุฌุฏุฏ

### ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฐุฎุฑูโุดุฏู:

```python
from tensorflow.keras.models import load_model
model = load_model("tts_model.h5")
```

### ุงุฏุงููู ุขููุฒุด:

```python
model.fit(dataset, epochs=10)
model.save("tts_model_updated.h5")
```

---

## ุณุฎุชโุงูุฒุงุฑ ููุฑุฏ ูุงุฒ

* **GPU** ูพุดููุงุฏ ูโุดูุฏ (ูุซูุงู RTX 2060 ุจู ุจุงูุง).
* ุฑู CPU ุขููุฒุด ุจุณุงุฑ ฺฉูุฏ ุฎูุงูุฏ ุจูุฏ.
* ุจุฑุง ฺฉูุช ุจุงูุง ู ุฏุชุงุณุช ุจุฒุฑฺฏุ ูุงุฒ ุจู ฺูุฏ GPU ู ุฒูุงู ุทููุงู ุฏุงุฑุฏ.

---

## ฺฺฉโูุณุช ุณุฑุน (Step by Step)

1. ุณุงุฎุชุงุฑ ูพูุดู ุฑุง ุจุณุงุฒ.
2. ูุงูโูุง WAV ู metadata.csv ุฑุง ุขูุงุฏู ฺฉู.
3. `main.py` ุฑุง ุงุฌุฑุง ฺฉู ุจุง `--mode train`.
4. ุจุนุฏ ุงุฒ ุขููุฒุดุ ุจุง `--mode synth` ูุชู ุฑุง ุจู ฺฏูุชุงุฑ ุชุจุฏู ฺฉู.
5. ุจุฑุง ุงุฑุชูุง ฺฉูุช โ ููููโุณุงุฒ + vocoder ููโุชุฑ.

---

## ููุงุจุน ูพุดููุงุฏ

* [Tacotron2 Paper](https://arxiv.org/abs/1712.05884)
* [FastSpeech2 Paper](https://arxiv.org/abs/2006.04558)
* [HiFi-GAN Vocoder](https://arxiv.org/abs/2010.05646)
* [TensorFlowTTS Library](https://github.com/TensorSpeech/TensorFlowTTS)
* [Coqui TTS](https://github.com/coqui-ai/TTS)

---

๐ฏ ุจุง ุงู ุฑุงูููุงุ ูโุชูุงู ฺฉ ุณุณุชู ูพุงูู TTS ูุงุฑุณ ุจุณุงุฒุ ุขู ุฑุง ุชุณุช ฺฉู ู ฺฉูโฺฉู ุงุฑุชูุง ุจุฏู.
